---
title: è®©Powershellæ›´å¥½ç”¨, Windowsä¸‹ç›®å‰æœ€å¥½ç”¨çš„ç»ˆç«¯å·¥å…·-Windows TerminalæŠ˜è…¾è®°
date: 2021-06-29
tags:
- window terminal
- ä¸»é¢˜
- ç»ˆç«¯
categories: 
- tools
---

## è£…X

ç†Ÿè¯è¯´ï¼šâ€œ~~æ¼‚äº®~~ï¼ˆZBï¼‰æ˜¯ç¬¬ä¸€ç”Ÿäº§åŠ›â€ï¼Œæ—¢ç„¶éƒ½æ˜¯é»‘æ¡†æ¡†ï¼Œä½ å¸Œæœ›æ˜¯è¿™æ ·çš„é»‘æ¡†æ¡†ï¼š
![dos](https://i.loli.net/2021/07/01/Axas2bnNV6DJLvQ.png)
è¿˜æ˜¯è¿™æ ·çš„ï¼š
![git-bash](https://i.loli.net/2021/07/01/EnDZ95XfQLuhUW2.png)
åˆæˆ–è€…æ˜¯è¿™æ ·çš„ï¼š
![powershell](https://i.loli.net/2021/07/01/HIzt8jAevWsrxSq.png)
ä¸ï¼
è¿™å¹¶ä¸æ˜¯æˆ‘æƒ³è¦çš„ï¼Œæ¯å¤©è¦é¢å¯¹çš„é»‘æ¡†æ¡†ã€‚é™¤éæˆ‘å®¡ç¾æœ‰é—®é¢˜ï¼Œ è¦ä¸ç„¶è°ä¸å–œæ¬¢ä¸‹é¢è¿™ä¸ªï¼š
![windows-terminal](https://i.loli.net/2021/07/01/7C5BgHtISyKbjiz.png)

## å¦‚ä½•è£…X

åˆ°è¿™é‡Œå¯èƒ½æœ‰äº›ä¸æ˜æ‰€ä»¥çš„å°ä¼™ä¼´å°±è¦é—®äº†ï¼šâ€œæ‰€ä»¥ä½ è¿™è¯´çš„éƒ½æ˜¯å•¥ï¼Œæ²¡æ˜ç™½ä½ è£…åœ¨å“ªé‡Œï¼Ÿâ€

### Windows Terminal

æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œå…¨çƒæœ€å¤§è£…æœºé‡çš„æ“ä½œç³»ç»Ÿæ˜¯Windowsï¼Œç„¶è€Œè¿™æ ·ä¸€ä¸ªç³»ç»Ÿå´æœ‰ä¸€ä¸ªåˆä¸‘æœ‰éš¾ç”¨çš„ç»ˆç«¯-å‘½ä»¤æç¤ºç¬¦ï¼Œè¿™ä½¿å¾—å¾ˆå¤šå¼€å‘è€…é€€è€Œé€‰æ‹©linuxå‘è¡Œç‰ˆè¿›è¡Œå¼€å‘ï¼Œå½“ç„¶ä»–ä»¬é€‰æ‹©linuxè‚¯å®šè¿˜æœ‰å…¶ä»–åŸå› ï¼Œå¾®è½¯ä¼°è®¡è‡ªå·±äººéƒ½åœ¨åæ§½è‡ªå·±çš„å¼€å‘å·¥å…·æœ‰å¤šéš¾ç”¨ï¼Œæ‰€ä»¥é™†ç»­å¼€å‘äº†linuxå­ç³»ç»Ÿã€Windows Terminalç­‰å¼€å‘è€…å‹å¥½çš„å·¥å…·ï¼Œè¿™æ‰ä½¿å¾—æˆ‘åœ¨Windowsç¯å¢ƒä¹Ÿèƒ½æœ‰ä¸é”™çš„å¼€å‘ä½“éªŒã€‚åœ¨ä¸€ä¼—ä½¿ç”¨cmdã€powershellã€git-bashåŸç”Ÿç»ˆç«¯çš„å°ä¼™ä¼´ä¸­æˆä¸ºç„¦ç‚¹ã€‚

è¯´äº†é‚£ä¹ˆå¤šåºŸè¯ï¼Œä¸‹é¢æˆ‘ä»¬è¿˜æ˜¯ä»å®è·µä¸­æ¥æ¢ç´¢ä¸€ä¸‹Windows Terminalå§ã€‚

#### å®‰è£…

æ‰“å¼€Microsoft Storeæœç´¢Windows Terminalå®‰è£…å³å¯ã€‚
![microsoft-windows-terminal](https://i.loli.net/2021/07/01/1Uat5BJD6mNuCoH.png)

#### é…ç½®ä¸»é¢˜

æœ€æ–°ç‰ˆçš„Windows Terminalå…·æœ‰GUIé…ç½®ç•Œé¢ï¼Œä½ å¯ä»¥åœ¨è®¾ç½®é€‰é¡¹å¡è¿›è¡ŒGUIçš„é…ç½®ï¼Œå¦‚æœä¸å–œæ¬¢GUIç•Œé¢é…ç½®ï¼Œä½ è¿˜å¯ä»¥ä½¿ç”¨JSONé…ç½®çš„æ–¹å¼ï¼Œç‚¹å‡»æ‰“å¼€JSONæ–‡ä»¶å³å¯ã€‚

æ‰“å¼€[windowsterminalthemes](https://windowsterminalthemes.dev/)ï¼Œé€‰æ‹©ä¸€ä¸ªä½ å–œæ¬¢çš„ä¸»é¢˜ï¼Œ ç„¶åå¤åˆ¶åˆ°JSONæ–‡ä»¶schemesæ•°ç»„ä¸­ï¼Œ å¦‚ï¼š

```JSON
{
  ...
  "profiles": 
    {
      "defaults": {},
      "list": 
      [
          {
              "acrylicOpacity": 0.5,        // é€æ˜åº¦
              "antialiasingMode": "cleartype",  // å­—ä½“æ¸²æŸ“æ–¹å¼
              "backgroundImage": null,          // èƒŒæ™¯å›¾
              "backgroundImageOpacity": 0.14999999999999999,  // èƒŒæ™¯å›¾é€æ˜åº¦
              "backgroundImageStretchMode": "uniformToFill",  // èƒŒæ™¯å›¾å¡«å……æ–¹å¼
              "colorScheme": "Monokai Vivid",     // é¢œè‰²ä¸»é¢˜
              "commandline": "powershell.exe -NoLogo",  // æ‰§è¡Œçš„å‘½ä»¤
              "fontFace": "JetBrainsMono Nerd Font",    // å­—ä½“
              "guid": "{61c54bbd-c2c6-5271-96e7-009a87ff44bf}",  // guid å¯é€šè¿‡powershellçš„New-Guidç”Ÿæˆ
              "hidden": false,  // æ˜¯å¦éšè—æ ‡é¢˜
              "icon": "âš½",    // iconï¼Œ å¯ä½¿ç”¨emoji
              "name": "Windows PowerShell",  // æ ‡é¢˜
              "useAcrylic": true     // æ˜¯å¦ä½¿ç”¨æ¯›ç»ç’ƒæ•ˆæœ
          },
          {
              "commandline": "cmd.exe",
              "guid": "{0caa0dad-35be-5f56-a8ff-afceeeaa6101}",
              "hidden": false,
              "name": "cmd"
          },
          {
              "guid": "{b453ae62-4e3d-5e58-b989-0a998ec441b8}",
              "hidden": false,
              "name": "Azure Cloud Shell",
              "source": "Windows.Terminal.Azure"
          },
          {
              "colorScheme": "Monokai Vivid",
              "commandline": "wsl",
              "fontFace": "JetBrainsMono Nerd Font",
              "guid": "{07b52e3e-de2c-5db4-bd2d-ba144ed6c273}",
              "hidden": false,
              "icon": "ğŸ§",
              "name": "Ubuntu-20.04",
              "source": "Windows.Terminal.Wsl"
          }
        ]
  },
  "schemes": 
    [
        {
            "background": "#0C0C0C",
            "black": "#0C0C0C",
            "blue": "#0037DA",
            "brightBlack": "#CC98E3",
            "brightBlue": "#3B78FF",
            "brightCyan": "#61D6D6",
            "brightGreen": "#16C60C",
            "brightPurple": "#B4009E",
            "brightRed": "#E74856",
            "brightWhite": "#F2F2F2",
            "brightYellow": "#F9F1A5",
            "cursorColor": "#FFFFFF",
            "cyan": "#3A96DD",
            "foreground": "#CCCCCC",
            "green": "#13A10E",
            "name": "Campbell",
            "purple": "#881798",
            "red": "#C50F1F",
            "selectionBackground": "#FFFFFF",
            "white": "#CCCCCC",
            "yellow": "#C19C00"
        },
        {
            "background": "#012456",
            "black": "#0C0C0C",
            "blue": "#0037DA",
            "brightBlack": "#767676",
            "brightBlue": "#3B78FF",
            "brightCyan": "#61D6D6",
            "brightGreen": "#16C60C",
            "brightPurple": "#B4009E",
            "brightRed": "#E74856",
            "brightWhite": "#F2F2F2",
            "brightYellow": "#F9F1A5",
            "cursorColor": "#FFFFFF",
            "cyan": "#3A96DD",
            "foreground": "#CCCCCC",
            "green": "#13A10E",
            "name": "Campbell Powershell",
            "purple": "#881798",
            "red": "#C50F1F",
            "selectionBackground": "#FFFFFF",
            "white": "#CCCCCC",
            "yellow": "#C19C00"
        },
        {
            "background": "#121212",
            "black": "#121212",
            "blue": "#0443FF",
            "brightBlack": "#ABA78B",
            "brightBlue": "#0443FF",
            "brightCyan": "#51CEFF",
            "brightGreen": "#B1E05F",
            "brightPurple": "#F200F6",
            "brightRed": "#F6669D",
            "brightWhite": "#FFFFFF",
            "brightYellow": "#FFF26D",
            "cursorColor": "#FB0007",
            "cyan": "#01B6ED",
            "foreground": "#F9F9F9",
            "green": "#98E123",
            "name": "Monokai Vivid",
            "purple": "#F800F8",
            "red": "#FA2934",
            "selectionBackground": "#FFFFFF",
            "white": "#FFFFFF",
            "yellow": "#FFF30A"
        }
    ]
}
```

#### å®‰è£…Oh-My-Posh

å¸¸ç”¨linuxçš„äººåº”è¯¥å¯¹Oh-My-Zshä¸é™Œç”Ÿï¼ŒOh-My-ZshåŠ ä¸Šä¼—å¤šçš„pluginï¼Œä½¿ç»ˆç«¯ä½¿ç”¨çš„èˆ’é€‚åº¦æå‡äº†å¾ˆå¤šï¼Œ[Oh-My-Posh](https://ohmyposh.dev/)å³æ˜¯å¯¹powershellåšpromptç¾åŒ–çš„ä¸€ä¸ªå¼•æ“ã€‚

ç®¡ç†å‘˜èº«ä»½æ‰“å¼€powershell, æ‰§è¡Œï¼š

```powershell
Install-Module oh-my-posh -Scope CurrentUser
```

è‹¥æç¤ºä¸å…è®¸å®‰è£…æ˜¯å› ä¸ºWindowsçš„è„šæœ¬æ‰§è¡Œç­–ç•¥é˜»æ­¢çš„ï¼Œéœ€è¦ä¿®æ”¹ç­–ç•¥ï¼ŒåŒæ ·ç®¡ç†å‘˜è¿è¡Œï¼š

```powershell
Set-ExecutionPolicy RemoteSigned -Scope CurrentUser -Confirm
```

å®‰è£…å¥½ä¹‹åæ‰§`Import-Module oh-my-posh`å¯¼å…¥æ¨¡å—ï¼Œå› ä¸ºå¯¼å…¥åªåœ¨ä¼šè¯èŒƒå›´å†…æœ‰æ•ˆï¼Œä¸ºäº†ä¿è¯æ¯æ¬¡å¼€å¯ç»ˆç«¯ä¹‹å‰éƒ½å¯¼å…¥æ¨¡å—ï¼Œåœ¨powershellå¯åŠ¨è„šæœ¬ä¸­åŠ å…¥ä»£ç ã€‚ä½¿ç”¨ç¼–è¾‘å™¨æ‰“å¼€$profileï¼Œæˆ‘ç”¨çš„ç¼–è¾‘å™¨æ˜¯vscodeã€‚

```powershell
code $profile  # ç”¨vscodeæ‰“å¼€powershellé…ç½®æ–‡ä»¶ï¼Œæ²¡æœ‰è¿™ä¸ªæ–‡ä»¶ä¼šè‡ªå·±åˆ›å»º
```

`$profile`ç±»ä¼¼`.bashrc`ï¼Œæ¯æ¬¡å¼€å¯ä¸€ä¸ªä¼šè¯éƒ½ä¼šæ‰§è¡Œè¯¥è„šæœ¬ï¼Œé€‚åˆå°†å„ç§aliasæ”¾åˆ°å…¶ä¸­ï¼Œæ–‡ä»¶ä¸­æ·»åŠ 

```powershell
Import-Module oh-my-posh
```

#### é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„promptä¸»é¢˜

Oh-My-Poshå†…ç½®äº†å¤šä¸ªä¸»é¢˜ï¼Œå…¶é¢œå€¼å’Œå®ç”¨æ€§æˆ‘è§‰å¾—å¤Ÿç”¨äº†ï¼Œä½¿ç”¨`Get-PoshThemes`å¯é¢„è§ˆæ‰€æœ‰ä¸»é¢˜ã€‚
![poshthemes](https://i.loli.net/2021/07/01/4AK6Jey9VHMiYq1.png)
ä½¿ç”¨`Set-PoshPrompt -Theme $THEME`è®¾ç½®ä¸»é¢˜ï¼Œé€‰å¥½ä¸»é¢˜ä¹‹åä¹Ÿå°†è®¾ç½®ä¸»é¢˜çš„è„šæœ¬å†™åˆ°profileä¸­ï¼š

```powershell
Import-Module oh-my-posh
Set-PoshPrompt -Theme ys  # æˆ‘ä½¿ç”¨ysä¸»é¢˜
```

#### é€‰æ‹©ä¸€ä¸ªç­‰å®½å­—ä½“

ä¹Ÿè®¸ä½ çš„ä¸»é¢˜ä¼šæœ‰äº›å­—ç¬¦æ˜¾ç¤ºä¸å‡ºï¼Œæ¯”å¦‚è¿™æ ·çš„ï¼š
![font](https://i.loli.net/2021/07/01/hwkPcZmKvf7Ny9H.png)
è¿™æ˜¯å› ä¸ºå­—ä½“ä¸æ”¯æŒå›¾æ ‡å¼•èµ·çš„ï¼Œéœ€è¦Nerdå­—ä½“æ–¹å¯è§£å†³è¿™ä¸ªé—®é¢˜ã€‚å…·ä½“å¯å‚è€ƒè¿™ä¸ªé¡¹ç›®: [Nerd Font](https://github.com/ryanoasis/nerd-fonts)
æˆ‘æ˜¯ç”¨çš„æ˜¯[JetbrainsMono Nerd Patcher](https://raw.githubusercontent.com/ryanoasis/nerd-fonts/master/patched-fonts/JetBrainsMono/Ligatures/Regular/complete/JetBrains%20Mono%20Regular%20Nerd%20Font%20Complete%20Mono%20Windows%20Compatible.ttf)çš„å­—ä½“ã€‚å®‰è£…å­—ä½“ä¹‹åå¯åœ¨è®¾ç½®ç•Œé¢é€‰æ‹©è¯¥å­—ä½“ï¼š
![setup-font](https://i.loli.net/2021/07/01/Oy3frwQ5lmtHGVI.png)

#### å…¶ä»–ä¸€äº›è®¾ç½®

è‡³äºæ·»åŠ èƒŒæ™¯å›¾ï¼Œè®¾ç½®é€æ˜åº¦ç­‰è¿™äº›è®¾ç½®ç›¸ä¿¡å°±ä¸ç”¨æˆ‘å¤šè¯´ä»€ä¹ˆäº†ï¼Œç›¸ä¿¡ä½ ä¹Ÿèƒ½é…å‡ºä¸€ä¸ªé«˜é¢œå€¼çš„ç»ˆç«¯ï¼Œ æœ€åè´´å‡ºæˆ‘çš„JSONè®¾ç½®å’Œprofileä¾›å¤§å®¶å‚è€ƒã€‚
æœ€åè¯´ä¸€ä¸‹ä¸€äº›ä¸»é¢˜çš„é¢œè‰²é…ç½®åœ¨å‘½ä»¤çš„å‚æ•°å¦‚ï¼š`git --version`ä¸­`--version`å¯èƒ½ä¼šå¾ˆéš¾è¾¨è®¤ï¼Œä¸»è¦å› ä¸ºè¯¥é¢œè‰²å’ŒèƒŒæ™¯è‰²çš„å¯¹æ¯”åº¦å¤ªä½ã€‚
![param-color](https://i.loli.net/2021/07/01/oKnaA7dMel2kJuO.png)
è¿™ä¸ªæ—¶å€™æ¢ä¸€ä¸ªä¸»é¢˜å½“ç„¶æ˜¯ä¸ªåŠæ³•ï¼Œä½†å¦‚æœä½ çœŸå¾ˆå–œæ¬¢è¿™ä¸ªä¸»é¢˜ä¹Ÿä¸æ˜¯æ²¡æœ‰è§£å†³æ–¹æ³•ï¼Œæ‰“å¼€è®¾ç½®-é…è‰²æ–¹æ¡ˆï¼Œæ‰¾åˆ°å¯¹æ¯”åº¦å¾ˆä½çš„é¢œè‰²ï¼Œä¿®æ”¹ä¸ºç›¸å¯¹èƒŒæ™¯è‰²é«˜ä¸€ç‚¹çš„é¢œè‰²å³å¯ï¼Œæ‰¾ä¸åˆ°é¢œè‰²ï¼Œç›¸ä¼¼çš„è¯•ä¸€ä¸‹æ€»ä¼šä½¿å‡ºæ¥çš„ã€‚
![theme-color-high](https://i.loli.net/2021/07/01/nIQTlyp4tAuWDwh.png)

JSONé…ç½®ï¼ˆçœç•¥äº†ä¸€äº›é…ç½®ï¼‰ï¼š

```JSON
{
    "$schema": "https://aka.ms/terminal-profiles-schema",
    "actions": 
    [
        {
            "command": 
            {
                "action": "copy",
                "singleLine": false
            },
            "keys": "ctrl+c"
        },
        {
            "command": "paste",
            "keys": "ctrl+v"
        },
        {
            "command": "find",
            "keys": "ctrl+shift+f"
        },
        {
            "command": 
            {
                "action": "splitPane",
                "split": "auto",
                "splitMode": "duplicate"
            },
            "keys": "alt+shift+d"
        }
    ],
    "copyFormatting": "none",
    "copyOnSelect": false,
    "defaultProfile": "{61c54bbd-c2c6-5271-96e7-009a87ff44bf}",
    "profiles": 
    {
        "defaults": {},
        "list": 
        [
            {
                "acrylicOpacity": 0.5,
                "antialiasingMode": "cleartype",
                "backgroundImage": null,
                "backgroundImageOpacity": 0.14999999999999999,
                "backgroundImageStretchMode": "uniformToFill",
                "colorScheme": "Monokai Vivid",
                "commandline": "powershell.exe -NoLogo",
                "fontFace": "JetBrainsMono Nerd Font",
                "guid": "{61c54bbd-c2c6-5271-96e7-009a87ff44bf}",
                "hidden": false,
                "icon": "\u26bd",
                "name": "Windows PowerShell",
                "useAcrylic": true
            },
            {
                "commandline": "cmd.exe",
                "guid": "{0caa0dad-35be-5f56-a8ff-afceeeaa6101}",
                "hidden": false,
                "name": "\u547d\u4ee4\u63d0\u793a\u7b26"
            },
            {
                "guid": "{b453ae62-4e3d-5e58-b989-0a998ec441b8}",
                "hidden": false,
                "name": "Azure Cloud Shell",
                "source": "Windows.Terminal.Azure"
            },
            {
                "colorScheme": "Monokai Vivid",
                "commandline": "wsl",
                "fontFace": "JetBrainsMono Nerd Font",
                "guid": "{07b52e3e-de2c-5db4-bd2d-ba144ed6c273}",
                "hidden": false,
                "icon": "\ud83d\udc27",
                "name": "Ubuntu-20.04",
                "source": "Windows.Terminal.Wsl"
            }
        ]
    },
    "schemes": 
    [
        {
            "background": "#121212",
            "black": "#121212",
            "blue": "#0443FF",
            "brightBlack": "#ABA78B",
            "brightBlue": "#0443FF",
            "brightCyan": "#51CEFF",
            "brightGreen": "#B1E05F",
            "brightPurple": "#F200F6",
            "brightRed": "#F6669D",
            "brightWhite": "#FFFFFF",
            "brightYellow": "#FFF26D",
            "cursorColor": "#FB0007",
            "cyan": "#01B6ED",
            "foreground": "#F9F9F9",
            "green": "#98E123",
            "name": "Monokai Vivid",
            "purple": "#F800F8",
            "red": "#FA2934",
            "selectionBackground": "#FFFFFF",
            "white": "#FFFFFF",
            "yellow": "#FFF30A"
        }
    ],
    "theme": "system"
}
```

profile:

```powershell
# some custome scripts

# import on-my-posh
Import-Module oh-my-posh

# setup oh-my-posh theme
Set-PoshPrompt -Theme ys

# alais scripts
. C:\Users\linkzz\ps-scripts\alais.ps1
```

è‡³æ­¤Windows Terminalç¾åŒ–å°±è¯´å®Œäº†ï¼Œåˆ°è¿™é‡Œä½ å¯ä»¥å»ç»™ä½ çš„å°ä¼™ä¼´ä»¬è£…Xäº†ï¼Œä½†è¿™åªç®—è£…Xåˆšå…¥é—¨é˜¶æ®µï¼Œ è¦æƒ³æ›´å¥½çš„è£…Xï¼Œæƒ³è¦æ›´å¤šå¥½ç”¨çš„ç»ˆç«¯åŠŸèƒ½ï¼Œä¸‹ä¸€ç« æˆ‘ä»¬ç»§ç»­ã€‚
